image: Visual Studio 2017

cache: 
  - .tmp
    
before_build:
  - ps: gitversion /l console /output buildserver
    
build_script:
  - ps: .\build.ps1 -configuration Release -target Compile
    
test_script:
  - ps: .\build.ps1 -configuration Release -target Test

for:
-
  branches:
    only:
      - master
      
  environment:
    NuGet:
      secure: AgGuN2dj1G3cBYu4MCnpxLzXxbJjLzpbkW/2/kQFVblitZ1T4W2U5zlVKr3q7lb4
    
  after_test:
    - ps: .\build.ps1 -configuration Release -target Pack
    
  artifacts:
    - path: 'output\packages\*.nupkg'
    
  deploy_script:
    - ps: .\build.ps1 -configuration Release -target Publish -ApiKey $env:NuGet
